<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Created Characters</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="profilePage">
    <h1>
        <span class="tab" onclick="loadCharacters('mine')">My Characters</span>
        <span class="separator">|</span>
        <span class="tab" onclick="loadCharacters('favorites')">My Favorites</span>
    </h1>
    <button onclick="window.location.href='index.html';" class="back-btn">Back</button>
    <div class="character-grid" id="characterGrid"> Loading characters...
      <script type="module">
        import { populateGrid } from './characterGrid.js';
    
        async function loadCharacters(type) {
          try {
            const response = await fetch('https://chatcord-server.onrender.com/get-characters');
            const data = await response.json();
    
            // Get the current user's ID from localStorage
            const user = JSON.parse(localStorage.getItem('user'));
            const myUserId = user ? user.id : null;
            if (!myUserId) {
              document.getElementById('characterGrid').innerText = "User not logged in or user ID missing.";
              return;
            }
            
            console.error(type);
            if(type == 'mine') {
              // Filter characters by userID
              const characterArray = Object.entries(data).filter(([id, character]) => character.userID === myUserId);
              
              console.error(type);
            }  else if(type == 'favorites') {
              // Filter characters by userID
              const characterArray = Object.entries(data).filter(([id, character]) => character.userID != myUserId);
              
              console.error(type);
            }
            populateGrid(characterArray,[], [], false);
    
          } catch (error) {
            console.error("Error fetching characters:", error);
            document.getElementById('characterGrid').innerText = "Failed to load characters.";
          }
        }
        // Call the function on page load
        window.addEventListener('DOMContentLoaded', () => loadCharacters('mine'));
      </script>
    </div>
  </div>
</body>
</html>
